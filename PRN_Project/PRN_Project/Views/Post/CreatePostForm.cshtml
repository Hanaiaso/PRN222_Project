@model int
@{
    var classroomId = Model;
}

<div class="post-form">
    <h5>üìù ƒêƒÉng b√†i m·ªõi</h5>
    <form asp-controller="Post" asp-action="Create" method="post">
        @Html.AntiForgeryToken()
        <input type="hidden" name="classroomId" value="@classroomId" />
        
        <!-- Ch·ªçn lo·∫°i b√†i ƒëƒÉng -->
        <div class="post-type-toggle">
            <div class="post-type-btn active" data-type="Announcement" onclick="selectPostType('Announcement')">
                üì¢ Th√¥ng b√°o
            </div>
            <div class="post-type-btn" data-type="Assignment" onclick="selectPostType('Assignment')">
                üìö B√†i t·∫≠p
            </div>
        </div>
        <input type="hidden" name="postType" id="postType" value="Announcement" />
        
        <!-- Ti√™u ƒë·ªÅ -->
        <input type="text" name="title" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ..." required />
        
        <!-- N·ªôi dung -->
        <textarea name="content" placeholder="Nh·∫≠p n·ªôi dung..." required></textarea>
        
        <!-- H·∫°n n·ªôp (ch·ªâ hi·ªán khi ch·ªçn B√†i t·∫≠p) -->
        <div class="due-date-field" id="dueDateField" style="display: none;">
            <label>‚è∞ H·∫°n n·ªôp:</label>
            <div style="display: flex; gap: 10px; align-items: center;">
                <input type="date" id="dueDate" required style="flex: 1;" />
                <input type="time" id="dueTime" required style="flex: 1;" step="1" />
                <input type="hidden" name="dueDate" id="dueDateHidden" />
            </div>
            <small style="color: #666; font-size: 0.85rem;">ƒê·ªãnh d·∫°ng 24 gi·ªù (VD: 14:30)</small>
        </div>
        
        <button type="submit" class="btn btn-primary">ƒêƒÉng b√†i</button>
    </form>
</div>

<script>
    function selectPostType(type) {
        // C·∫≠p nh·∫≠t hidden input
        document.getElementById('postType').value = type;
        
        // C·∫≠p nh·∫≠t UI c·ªßa c√°c n√∫t
        document.querySelectorAll('.post-type-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.closest('.post-type-btn').classList.add('active');
        
        // Hi·ªÉn th·ªã/·∫©n tr∆∞·ªùng h·∫°n n·ªôp
        const dueDateField = document.getElementById('dueDateField');
        const dueDateInput = document.getElementById('dueDate');
        const dueTimeInput = document.getElementById('dueTime');
        if (type === 'Assignment') {
            dueDateField.style.display = 'block';
            dueDateField.classList.add('show');
            dueDateInput.required = true;
            dueTimeInput.required = true;
        } else {
            dueDateField.style.display = 'none';
            dueDateField.classList.remove('show');
            dueDateInput.required = false;
            dueTimeInput.required = false;
            dueDateInput.value = '';
            dueTimeInput.value = '';
            document.getElementById('dueDateHidden').value = '';
        }
    }

    // K·∫øt h·ª£p date v√† time th√†nh datetime-local format tr∆∞·ªõc khi submit
    document.querySelector('form').addEventListener('submit', function(e) {
        const postType = document.getElementById('postType').value;
        if (postType === 'Assignment') {
            const dateInput = document.getElementById('dueDate');
            const timeInput = document.getElementById('dueTime');
            const hiddenInput = document.getElementById('dueDateHidden');
            
            if (dateInput.value && timeInput.value) {
                // K·∫øt h·ª£p date v√† time th√†nh format: YYYY-MM-DDTHH:mm
                const dateTimeValue = dateInput.value + 'T' + timeInput.value;
                hiddenInput.value = dateTimeValue;
            }
        }
    });
</script>

