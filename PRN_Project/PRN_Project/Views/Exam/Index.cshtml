@model IEnumerable<PRN_Project.Models.Exam>
@using System.Security.Claims

@{
    ViewData["Title"] = "Danh sách bài thi";
}

<h2 class="text-center mb-4">Danh sách bài thi</h2>

<div class="text-end mb-3">
    <a asp-action="Create" class="btn btn-success">+ Thêm bài thi mới</a>
</div>

<table class="table table-bordered table-striped">
    <thead class="table-dark text-center">
        <tr>
            <th>Mã</th>
            <th>Tên bài thi</th>
            <th>Môn học</th>
            <th>Ngày tạo</th>
            <th>Thời gian bắt đầu</th>
            <th>Thời gian kết thúc</th>
            <th>Trạng thái</th>
            <th>Thao tác</th>
        </tr>
    </thead>
    <tbody>
        @if (Model != null && Model.Any())
        {
            foreach (var item in Model)
            {
                <tr>
                    <td>@item.EId</td>
                    <td>@item.EName</td>
                    <td>@item.Subject?.SuName</td>
                    <td>@item.CreatedAt.ToString("dd/MM/yyyy")</td>
                    <td>@(item.StartTime?.ToString("HH:mm dd/MM/yyyy") ?? "-")</td>
                    <td>@(item.EndTime?.ToString("HH:mm dd/MM/yyyy") ?? "-")</td>
                    <td>@(item.Status ? "Hiển thị" : "Ẩn")</td>
                    <td class="text-center">
                        <a asp-action="Details" asp-route-id="@item.EId" class="btn btn-info btn-sm">Xem</a>
                        <a asp-action="Edit" asp-route-id="@item.EId" class="btn btn-warning btn-sm">Sửa</a>
                        <a asp-action="Delete" asp-route-id="@item.EId" class="btn btn-danger btn-sm">Xóa</a>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr><td colspan="8" class="text-center text-muted">Không có bài thi nào.</td></tr>
        }
    </tbody>
</table>
@{
    var role = Context.Session.GetString("role");
<!--     var role = User.FindFirstValue(ClaimTypes.Role); -->

    if (role == "Admin")
    {
        Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    }
    else if (role == "Teacher")
    {
        Layout = "~/Views/Shared/_LayoutTeacher.cshtml";
    }
}